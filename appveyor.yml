version: 1.0.{build}

platform:
  - x64

cache:
 - C:\Users\Appveyor\.conan -> conanfile.txt 
 - C:\.conan -> conanfile.txt

install:
  - cmd: echo "Downloading conan..."
  - cmd: pip.exe install conan
  - cmd: conan user # Create the conan data directory
  - cmd: conan --version
  - cmd: conan remote add bincrafters https://api.bintray.com/conan/bincrafters/public-conan

build_script:
  - cmd: conan install . -g qmake -g virtualenv
  - cmd: activate.bat
  - cmd: SET QTDIR=%CMAKE_PREFIX_PATH:;=%
  - cmd: call "C:\Program Files\Microsoft SDKs\Windows\v7.1\Bin\SetEnv.cmd" /x64
  - cmd: call "C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat" x86_amd64
  - cmd: SET
  - ps: Set-Content -Value "[Paths]`r`nPrefix=.." -Path ${Env:QTDIR}/bin/qt.conf
  - cmd: qmake --version
  - cmd: qmake -spec %QTDIR%\\mkspecs\\win32-msvc ModbusScope.pro
  - cmd: nmake

test_script:
        - cmd: dir
